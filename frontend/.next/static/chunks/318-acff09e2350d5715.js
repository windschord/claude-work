"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[318],{4790:function(t,a,e){e.d(a,{h:function(){return n}});let i=e(2949).env.NEXT_PUBLIC_API_URL||"http://localhost:8000";class c extends Error{constructor(t,a){super(a),this.status=t,this.name="ApiError"}}let n={async login(t){let a=new FormData;a.append("token",t);let e=await fetch("".concat(i,"/api/auth/login"),{method:"POST",body:a,credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"ログインに失敗しました"}));throw new c(e.status,t.detail||"ログインに失敗しました")}},async logout(){let t=await fetch("".concat(i,"/api/auth/logout"),{method:"POST",credentials:"include"});if(!t.ok){let a=await t.json().catch(()=>({detail:"ログアウトに失敗しました"}));throw new c(t.status,a.detail||"ログアウトに失敗しました")}},async checkAuth(){try{return(await fetch("".concat(i,"/api/auth/me"),{method:"GET",credentials:"include"})).ok}catch(t){return!1}},async getProjects(){let t=await fetch("".concat(i,"/api/projects"),{method:"GET",credentials:"include"});if(!t.ok){let a=await t.json().catch(()=>({detail:"プロジェクト一覧の取得に失敗しました"}));throw new c(t.status,a.detail||"プロジェクト一覧の取得に失敗しました")}return await t.json()},async createProject(t,a){let e=await fetch("".concat(i,"/api/projects"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,default_model:a}),credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"プロジェクトの作成に失敗しました"}));throw new c(e.status,t.detail||"プロジェクトの作成に失敗しました")}return await e.json()},async updateProject(t,a,e){let n=await fetch("".concat(i,"/api/projects/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,default_model:e}),credentials:"include"});if(!n.ok){let t=await n.json().catch(()=>({detail:"プロジェクトの更新に失敗しました"}));throw new c(n.status,t.detail||"プロジェクトの更新に失敗しました")}return await n.json()},async deleteProject(t){let a=await fetch("".concat(i,"/api/projects/").concat(t),{method:"DELETE",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"プロジェクトの削除に失敗しました"}));throw new c(a.status,t.detail||"プロジェクトの削除に失敗しました")}},async getSessions(t){let a=await fetch("".concat(i,"/api/projects/").concat(t,"/sessions"),{method:"GET",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"セッション一覧の取得に失敗しました"}));throw new c(a.status,t.detail||"セッション一覧の取得に失敗しました")}return await a.json()},async createSession(t,a,e,n,s){let o=await fetch("".concat(i,"/api/projects/").concat(t,"/sessions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,message:e||"",count:n,model:s}),credentials:"include"});if(!o.ok){let t=await o.json().catch(()=>({detail:"セッションの作成に失敗しました"}));throw new c(o.status,t.detail||"セッションの作成に失敗しました")}return await o.json()},async getSession(t){let a=await fetch("".concat(i,"/api/sessions/").concat(t),{method:"GET",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"セッションの取得に失敗しました"}));throw new c(a.status,t.detail||"セッションの取得に失敗しました")}return await a.json()},async stopSession(t){let a=await fetch("".concat(i,"/api/sessions/").concat(t,"/stop"),{method:"POST",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"セッションの停止に失敗しました"}));throw new c(a.status,t.detail||"セッションの停止に失敗しました")}},async deleteSession(t){let a=await fetch("".concat(i,"/api/sessions/").concat(t),{method:"DELETE",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"セッションの削除に失敗しました"}));throw new c(a.status,t.detail||"セッションの削除に失敗しました")}},async getMessages(t){let a=await fetch("".concat(i,"/api/sessions/").concat(t,"/messages"),{method:"GET",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"メッセージ一覧の取得に失敗しました"}));throw new c(a.status,t.detail||"メッセージ一覧の取得に失敗しました")}return await a.json()},async sendMessage(t,a){let e=await fetch("".concat(i,"/api/sessions/").concat(t,"/messages"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:a}),credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"メッセージの送信に失敗しました"}));throw new c(e.status,t.detail||"メッセージの送信に失敗しました")}return await e.json()},async respondToPermission(t,a,e){let n=await fetch("".concat(i,"/api/sessions/").concat(t,"/permissions/").concat(a),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({approved:e}),credentials:"include"});if(!n.ok){let t=await n.json().catch(()=>({detail:"権限確認の応答に失敗しました"}));throw new c(n.status,t.detail||"権限確認の応答に失敗しました")}},async getDiff(t){let a=await fetch("".concat(i,"/api/sessions/").concat(t,"/diff"),{method:"GET",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"Diff情報の取得に失敗しました"}));throw new c(a.status,t.detail||"Diff情報の取得に失敗しました")}return await a.json()},async rebaseFromMain(t){let a=await fetch("".concat(i,"/api/sessions/").concat(t,"/rebase"),{method:"POST",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"rebaseに失敗しました"}));throw new c(a.status,t.detail||"rebaseに失敗しました")}return await a.json()},async squashMerge(t,a){let e=await fetch("".concat(i,"/api/sessions/").concat(t,"/merge"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:a}),credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"マージに失敗しました"}));throw new c(e.status,t.detail||"マージに失敗しました")}return await e.json()},async getPromptHistory(t){let a=await fetch("".concat(i,"/api/projects/").concat(t,"/prompt-history"),{method:"GET",credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"プロンプト履歴の取得に失敗しました"}));throw new c(a.status,t.detail||"プロンプト履歴の取得に失敗しました")}return await a.json()},async savePromptHistory(t,a){let e=await fetch("".concat(i,"/api/projects/").concat(t,"/prompt-history"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt_text:a}),credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"プロンプト履歴の保存に失敗しました"}));throw new c(e.status,t.detail||"プロンプト履歴の保存に失敗しました")}return await e.json()},async deletePromptHistory(t,a){let e=await fetch("".concat(i,"/api/projects/").concat(t,"/prompt-history/").concat(a),{method:"DELETE",credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"プロンプト履歴の削除に失敗しました"}));throw new c(e.status,t.detail||"プロンプト履歴の削除に失敗しました")}},async getCommitHistory(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,e=await fetch("".concat(i,"/api/sessions/").concat(t,"/commits?limit=").concat(a),{method:"GET",credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"コミット履歴の取得に失敗しました"}));throw new c(e.status,t.detail||"コミット履歴の取得に失敗しました")}return await e.json()},async getCommitDiff(t,a){let e=await fetch("".concat(i,"/api/sessions/").concat(t,"/commits/").concat(a,"/diff"),{method:"GET",credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"コミットのdiff取得に失敗しました"}));throw new c(e.status,t.detail||"コミットのdiff取得に失敗しました")}return await e.json()},async resetToCommit(t,a){let e=await fetch("".concat(i,"/api/sessions/").concat(t,"/commits/").concat(a,"/reset"),{method:"POST",credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"コミットへのリセットに失敗しました"}));throw new c(e.status,t.detail||"コミットへのリセットに失敗しました")}return await e.json()},async getRunScripts(t){let a=await fetch("".concat(i,"/api/projects/").concat(t,"/run-scripts"),{credentials:"include"});if(!a.ok){let t=await a.json().catch(()=>({detail:"ランスクリプト一覧の取得に失敗しました"}));throw new c(a.status,t.detail||"ランスクリプト一覧の取得に失敗しました")}return await a.json()},async createRunScript(t,a,e){let n=await fetch("".concat(i,"/api/projects/").concat(t,"/run-scripts"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,command:e}),credentials:"include"});if(!n.ok){let t=await n.json().catch(()=>({detail:"ランスクリプトの作成に失敗しました"}));throw new c(n.status,t.detail||"ランスクリプトの作成に失敗しました")}return await n.json()},async updateRunScript(t,a,e,n){let s=await fetch("".concat(i,"/api/projects/").concat(t,"/run-scripts/").concat(a),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,command:n}),credentials:"include"});if(!s.ok){let t=await s.json().catch(()=>({detail:"ランスクリプトの更新に失敗しました"}));throw new c(s.status,t.detail||"ランスクリプトの更新に失敗しました")}return await s.json()},async deleteRunScript(t,a){let e=await fetch("".concat(i,"/api/projects/").concat(t,"/run-scripts/").concat(a),{method:"DELETE",credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"ランスクリプトの削除に失敗しました"}));throw new c(e.status,t.detail||"ランスクリプトの削除に失敗しました")}},async executeRunScript(t,a){let e=await fetch("".concat(i,"/api/execute-script/").concat(t,"/").concat(a),{method:"POST",credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({detail:"スクリプトの実行に失敗しました"}));throw new c(e.status,t.detail||"スクリプトの実行に失敗しました")}return await e.json()}}},7318:function(t,a,e){e.d(a,{t:function(){return n}});var i=e(4553),c=e(4790);let n=(0,i.U)(t=>({isAuthenticated:!1,isLoading:!1,error:null,login:async a=>{t({isLoading:!0,error:null});try{await c.h.login(a),t({isAuthenticated:!0,isLoading:!1})}catch(a){throw t({isAuthenticated:!1,isLoading:!1,error:a instanceof Error?a.message:"ログインに失敗しました"}),a}},logout:async()=>{t({isLoading:!0,error:null});try{await c.h.logout(),t({isAuthenticated:!1,isLoading:!1})}catch(a){throw t({isLoading:!1,error:a instanceof Error?a.message:"ログアウトに失敗しました"}),a}},checkAuth:async()=>{t({isLoading:!0});try{let a=await c.h.checkAuth();t({isAuthenticated:a,isLoading:!1})}catch(a){t({isAuthenticated:!1,isLoading:!1})}},clearError:()=>t({error:null})}))}}]);
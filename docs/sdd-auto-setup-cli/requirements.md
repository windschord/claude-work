# 要件定義: npx実行による全自動セットアップCLI

## 概要

`npx github:windschord/claude-work` コマンド一発でClaudeWorkを起動可能にする機能。
リポジトリのcloneやnpm installを意識することなく、npxコマンドのみで全自動セットアップと起動を実現する。

## ユーザーストーリー

### ストーリー1: 初回起動

**私は** ClaudeWorkを試したいユーザーとして
**~したい** `npx github:windschord/claude-work` を実行するだけで起動
**なぜなら** 複雑なセットアップ手順を踏まずに素早く試したいから

#### 受入基準（EARS記法）

- REQ-001: `npx github:windschord/claude-work` を実行した時、システムは必要な依存関係をインストールしなければならない
- REQ-002: Prismaクライアントが存在しない場合、システムは自動的にPrismaクライアントを生成しなければならない
- REQ-003: データベースファイルが存在しない場合、システムは自動的にデータベースを作成しスキーマを適用しなければならない
- REQ-004: Next.jsビルドが存在しない場合、システムは自動的にNext.jsをビルドしなければならない
- REQ-005: すべてのセットアップが完了した後、システムはサーバーをフォアグラウンドで起動しなければならない

### ストーリー2: 2回目以降の起動

**私は** 既にセットアップ済みの環境で起動するユーザーとして
**~したい** 素早くサーバーを起動
**なぜなら** 毎回セットアップを待ちたくないから

#### 受入基準（EARS記法）

- REQ-006: Prismaクライアントが既に存在する場合、システムはPrisma生成をスキップしなければならない
- REQ-007: データベースファイルが既に存在する場合、システムはデータベース作成をスキップしなければならない
- REQ-008: Next.jsビルドが既に存在し完全な場合、システムはビルドをスキップしなければならない

### ストーリー3: prepareスクリプトによる自動ビルド

**私は** npxでGitHubリポジトリを実行するユーザーとして
**~したい** npm install時にCLIが自動的にビルドされる
**なぜなら** TypeScriptソースからビルド済みJSが生成されないとCLIが動作しないから

#### 受入基準（EARS記法）

- REQ-009: `npm install` が実行された時、システムはprepareスクリプトでサーバーをビルドしなければならない
- REQ-010: prepareスクリプト実行後、`dist/src/bin/cli.js` が生成されていなければならない

## 非機能要件

- NFR-001: システムは依存関係が存在する場合、30秒以内にサーバーを起動できなければならない
- NFR-002: セットアップ中、システムは現在の進捗状況をコンソールに表示しなければならない
- NFR-003: エラーが発生した場合、システムは明確なエラーメッセージを表示して終了しなければならない

## スコープ外

- バックグラウンド起動（pm2）機能: 今回は最小限のCLIとしてフォアグラウンド起動のみ
- stop, restart, status, logs コマンド: 将来の拡張として対応
- help コマンド: 簡易的なものは残すが、詳細なヘルプは省略

## 用語定義

| 用語 | 定義 |
|------|------|
| prepare スクリプト | npm install 後に自動実行されるnpmライフサイクルスクリプト |
| npx github: | GitHubリポジトリを直接実行するnpxの機能 |
| Prisma クライアント | データベースアクセス用の自動生成コード |
| Next.js ビルド | 本番用にコンパイルされたNext.jsアプリケーション |

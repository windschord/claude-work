# 性能要件

> 非機能要件カテゴリ: 性能

## 概要

PTYアーキテクチャリファクタリングにより、既存の性能を維持しつつ、レスポンス性を向上させる。共通ロジック抽出による処理の効率化と、Circular delegation解消によるオーバーヘッド削減を実現する。

## 要件一覧

### NFR-PERF-001: セッション作成時間の維持

**EARS記法**: セッションを作成する時、システムはリファクタリング前と同等またはそれ以下の時間で処理を完了しなければならない

**測定基準**:
- 指標: セッション作成時間(PTYプロセス起動からready状態まで)
- 目標値: リファクタリング前と同等(HOST: 500ms以下、DOCKER: 2000ms以下)
- 測定方法: パフォーマンステストによる時間測定(N=100の平均値)

**関連する機能要件**: REQ-001-002, REQ-004-001

**優先度**: 中

**検証方法**:
- [ ] HOST環境で100回セッション作成を実行し、平均時間が500ms以下であることを確認
- [ ] DOCKER環境で100回セッション作成を実行し、平均時間が2000ms以下であることを確認
- [ ] リファクタリング前後の性能比較レポートを作成
- [ ] Circular delegation解消により、不要な呼び出しが削減されたことを確認

---

### NFR-PERF-002: リサイズ操作の応答性

**EARS記法**: ターミナルリサイズイベントを受信した時、システムは50ms以内にPTYプロセスをリサイズしなければならない

**測定基準**:
- 指標: リサイズ処理時間(WebSocketメッセージ受信からptyProcess.resize()完了まで)
- 目標値: 50ms以下
- 測定方法: パフォーマンステストによる時間測定(N=100の平均値)

**関連する機能要件**: REQ-003-003

**優先度**: 低

**検証方法**:
- [ ] 100回連続でリサイズイベントを送信し、平均応答時間が50ms以下であることを確認
- [ ] HOST環境とDOCKER環境の両方で検証
- [ ] リサイズ処理のボトルネックがないことを確認(プロファイリング)

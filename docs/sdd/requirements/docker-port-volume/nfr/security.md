# 非機能要件: セキュリティ

## NFR-001: ポート番号のバリデーション

システムは、ポート番号として1〜65535の範囲の整数値のみを受け付けなければならない。

## NFR-002: 危険パスの警告表示

システムは、OSのシステムディレクトリをホストパスとして入力した場合、セキュリティ警告を表示しなければならない。対象パスは `/etc`、`/proc`、`/sys`、`/dev`、`/root`、`/boot`、`/sbin`、`/bin`、`/usr/sbin` である。ユーザーが明示的に同意した場合のみ設定を許可する。

## NFR-003: パストラバーサル対策

システムは、ホストパスに対してパストラバーサル攻撃（`../`を使った上位ディレクトリへのアクセス）を防止するため、パスの正規化と検証を行わなければならない。

## NFR-004: システムボリュームの保護

システムは、カスタムボリュームマウントによってシステムが自動的にマウントするボリューム（/workspace, /home/node/.claude, /home/node/.config/claude, /home/node/.ssh, /home/node/.gitconfig）が上書きされることを防止しなければならない。

## NFR-005: 入力値のサニタイズ

システムは、ポートマッピングとボリュームマウントの入力値をdocker runコマンドに渡す前にサニタイズしなければならない。コマンドインジェクションの防止として、spawn()を使用し、shell経由の実行を避ける（既存実装に準拠）。

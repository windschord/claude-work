# US-005: 設定画面 UI の提供

## ユーザーストーリー

**私は** ClaudeWork の利用者として
**〜したい** Web ブラウザから直感的に開発ツール設定を管理したい
**なぜなら** コマンドラインやデータベースを直接操作することなく、簡単に設定を変更したいから

## 受入基準（EARS記法）

### 機能要件

#### ページ構成

- **REQ-005-001**: ユーザーが `/settings/developer` にアクセスした時、システムは開発ツール設定画面を表示しなければならない
- **REQ-005-002**: システムは「グローバル設定」と「プロジェクト別設定」の2つのタブを提供しなければならない
- **REQ-005-003**: システムは「SSH 鍵管理」セクションを両タブに共通で表示しなければならない

#### フォームバリデーション

- **REQ-005-004**: もし Git email が無効な形式の場合、システムは「有効なメールアドレスを入力してください」とエラーを表示しなければならない
- **REQ-005-005**: もし SSH 鍵の名前が既に存在する場合、システムは「この名前は既に使用されています」とエラーを表示しなければならない
- **REQ-005-006**: もし無効な SSH 鍵ファイルがアップロードされた場合、システムは「有効な SSH 鍵ファイルを選択してください」とエラーを表示しなければならない

#### フィードバック

- **REQ-005-007**: ユーザーが設定を保存した時、システムは「設定を保存しました」と成功メッセージを3秒間表示しなければならない
- **REQ-005-008**: もし保存に失敗した場合、システムはエラーメッセージを表示し続けなければならない（ユーザーが閉じるまで）
- **REQ-005-009**: システムは設定保存中にローディングインジケーターを表示しなければならない

#### レスポンシブ対応

- **REQ-005-010**: システムはモバイル画面（幅 768px 未満）でタブを縦並びに変更しなければならない
- **REQ-005-011**: システムはタブレット以上の画面（幅 768px 以上）でタブを横並びに表示しなければならない

## 画面/UI要件

### ページレイアウト

```
┌─────────────────────────────────────────────────┐
│ Settings > Developer Tools                      │
├─────────────────────────────────────────────────┤
│ [グローバル設定] [プロジェクト別設定]            │
├─────────────────────────────────────────────────┤
│                                                 │
│ ■ Git 設定                                      │
│   ┌─────────────────────────────────────────┐  │
│   │ Git Username: [____________]             │  │
│   │ Git Email:    [____________]             │  │
│   │              [保存]                      │  │
│   └─────────────────────────────────────────┘  │
│                                                 │
│ ■ SSH 鍵管理                                    │
│   ┌─────────────────────────────────────────┐  │
│   │ 鍵の名前:     [____________]             │  │
│   │ 秘密鍵:       [ファイル選択]             │  │
│   │ 公開鍵:       [ファイル選択] (オプション)│  │
│   │ パスフレーズ: [____________] (オプション)│  │
│   │              [追加]                      │  │
│   └─────────────────────────────────────────┘  │
│                                                 │
│   登録済み SSH 鍵:                              │
│   ┌─────────────────────────────────────────┐  │
│   │ 名前         │ 公開鍵       │ 登録日 │    │  │
│   │ GitHub       │ ssh-rsa AA.. │ 01/15 │[削]│  │
│   │ Bitbucket    │ ssh-ed25... │ 01/20 │[削]│  │
│   └─────────────────────────────────────────┘  │
│                                                 │
└─────────────────────────────────────────────────┘
```

### コンポーネント仕様

#### タブコンポーネント
- Headless UI の `Tab` コンポーネントを使用
- アクティブタブは青色ハイライト
- 非アクティブタブはグレー

#### 入力フィールド
- Tailwind CSS スタイリング
- フォーカス時に青色ボーダー
- エラー時に赤色ボーダー + エラーメッセージ（フィールド下部）

#### ボタン
- プライマリボタン: 青色背景、白文字
- セカンダリボタン（リセット等）: 白色背景、グレー枠、黒文字
- 削除ボタン: 赤色背景、白文字

#### SSH 鍵一覧テーブル
- 公開鍵は先頭 30 文字のみ表示 + "..."
- クリックでモーダルを開き、全文表示
- 削除ボタンクリックで確認ダイアログ表示

## データ要件

このストーリーは UI のみで、新規データ要件はありません。

API エンドポイント要件:
- `GET /api/developer-settings/global` - グローバル設定取得
- `PUT /api/developer-settings/global` - グローバル設定更新
- `GET /api/developer-settings/project/:projectId` - プロジェクト設定取得
- `PUT /api/developer-settings/project/:projectId` - プロジェクト設定更新
- `DELETE /api/developer-settings/project/:projectId` - プロジェクト設定削除
- `GET /api/ssh-keys` - SSH 鍵一覧取得
- `POST /api/ssh-keys` - SSH 鍵追加
- `DELETE /api/ssh-keys/:id` - SSH 鍵削除

## 関連ストーリー

- [US-001](US-001.md) @US-001.md: グローバル Git 設定の UI
- [US-002](US-002.md) @US-002.md: プロジェクト別 Git 設定の UI
- [US-003](US-003.md) @US-003.md: SSH 鍵管理の UI

## 備考

### アクセシビリティ

- すべてのフォーム要素に適切な `label` を設定
- エラーメッセージは `aria-live` で読み上げ
- キーボードナビゲーション対応（Tab キーでフォーカス移動）

### ユーザビリティ改善

1. **プレースホルダーでヒント表示**:
   - Git Username: "例: john.doe"
   - Git Email: "例: john@example.com"

2. **ツールチップ**:
   - SSH 鍵の名前: "識別しやすい名前を付けてください（例: GitHub Personal）"
   - パスフレーズ: "現在はパスフレーズなし鍵のみサポートしています"

3. **確認ダイアログ**:
   - SSH 鍵削除時: "本当に削除しますか？この操作は取り消せません。"
   - プロジェクト設定リセット時: "プロジェクト設定を削除してグローバル設定に戻しますか？"

### 既存 UI との統合

- `/settings/environments` や `/settings` と同じレイアウト・スタイルを使用
- サイドバーメニューに「Developer Tools」項目を追加

---

## EARS記法ガイド

### パターン選択
| パターン | キーワード | 使用場面 |
|---------|-----------|----------|
| 基本形 | (なし) | 常時適用される要件 |
| イベント | 〜の時 | 特定イベントで発動 |
| 条件付き | もし〜ならば | 条件成立時のみ適用 |
| 継続的 | 〜の間 | 状態が続く間適用 |
| 場所 | 〜において | 特定コンテキストで適用 |

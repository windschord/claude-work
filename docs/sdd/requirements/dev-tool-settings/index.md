# 要件定義: 開発ツール設定管理機能

## 概要

開発者の Git 設定（username, email）と SSH 鍵を一元管理し、階層的な設定構造（グローバル設定 → プロジェクト別上書き）により、Docker/HOST 実行環境に自動的に適用する機能を提供します。

この機能により、以下を実現します：
- プロジェクトごとに異なる Git アイデンティティの使い分け
- プライベートリポジトリへのシームレスなアクセス（SSH鍵管理）
- Docker 環境でのセッション起動時の自動設定注入
- セキュアな秘密鍵の保存と管理

## ユーザーストーリー一覧

| ID | タイトル | 優先度 | ステータス | 詳細リンク |
|----|---------|--------|-----------|------------|
| US-001 | グローバル Git 設定の管理 | 高 | 作成中 | [詳細](stories/US-001.md) @stories/US-001.md |
| US-002 | プロジェクト別 Git 設定の上書き | 高 | 作成中 | [詳細](stories/US-002.md) @stories/US-002.md |
| US-003 | SSH 鍵ペアの登録・管理 | 高 | 作成中 | [詳細](stories/US-003.md) @stories/US-003.md |
| US-004 | Docker 環境への設定自動適用 | 高 | 作成中 | [詳細](stories/US-004.md) @stories/US-004.md |
| US-005 | 設定画面 UI の提供 | 中 | 作成中 | [詳細](stories/US-005.md) @stories/US-005.md |

## 機能要件サマリ

| 要件ID | 概要 | 関連ストーリー | ステータス |
|--------|------|---------------|-----------|
| REQ-001 | グローバル Git username/email の保存・編集 | US-001 | 定義済 |
| REQ-002 | プロジェクト別 Git 設定の保存・編集・削除 | US-002 | 定義済 |
| REQ-003 | 階層的設定の優先順位制御（プロジェクト > グローバル） | US-002 | 定義済 |
| REQ-004 | SSH 秘密鍵/公開鍵ペアの登録 | US-003 | 定義済 |
| REQ-005 | SSH 鍵の暗号化保存（データベース内） | US-003 | 定義済 |
| REQ-006 | SSH 鍵の削除と安全な破棄 | US-003 | 定義済 |
| REQ-007 | Docker コンテナ起動時の git config 自動設定 | US-004 | 定義済 |
| REQ-008 | Docker コンテナへの SSH 鍵の安全なマウント | US-004 | 定義済 |
| REQ-009 | 設定画面の提供（/settings/developer） | US-005 | 定義済 |

## 非機能要件一覧

| カテゴリ | 詳細リンク | 要件数 |
|----------|------------|--------|
| 性能要件 | [詳細](nfr/performance.md) @nfr/performance.md | 2件 |
| セキュリティ要件 | [詳細](nfr/security.md) @nfr/security.md | 5件 |
| ユーザビリティ要件 | [詳細](nfr/usability.md) @nfr/usability.md | 3件 |
| 互換性要件 | [詳細](nfr/compatibility.md) @nfr/compatibility.md | 2件 |
| 拡張性要件 | [詳細](nfr/extensibility.md) @nfr/extensibility.md | 2件 |

## 依存関係

### 既存システムとの統合
- **ExecutionEnvironment テーブル**: Docker/HOST 環境設定との連携
- **Project テーブル**: プロジェクト別設定の紐付け
- **GitHubPAT テーブル**: 既存の認証情報との関係整理（SSH鍵と併存）

### 外部ライブラリ
- **node-forge** または **crypto**: SSH 秘密鍵の暗号化・復号化
- **ssh-keygen**: SSH 鍵ペアの生成（オプション）

### 技術的前提条件
- Drizzle ORM によるデータベーススキーマ管理
- Docker コンテナへのボリュームマウント機能
- Docker Adapter の拡張（設定注入機能の追加）

## スコープ外

以下の機能は本リリースのスコープ外とし、将来的な拡張で検討します：

- **他の開発ツール設定**: npm、Python pip、その他の CLI ツール設定
- **GPG 鍵管理**: Git コミット署名用の GPG 鍵管理
- **SSH Agent 連携**: ssh-agent への鍵の自動追加
- **環境別設定**: ExecutionEnvironment ごとの設定（現状はグローバル/プロジェクト別のみ）
- **設定のインポート/エクスポート**: 他の環境からの設定移行機能
- **SSH 鍵のパスフレーズ変更**: 登録済み鍵のパスフレーズ更新機能

---

## リンク形式について

詳細ファイルへのリンクは、マークダウン形式と`@`形式の両方を記載してください：
- **マークダウン形式**: `[詳細](stories/US-001.md)` - GitHub等での閲覧用
- **@形式**: `@stories/US-001.md` - Claude Codeがファイルを参照する際に使用

---

## ドキュメント構成

```
docs/sdd/requirements/dev-tool-settings/
├── index.md                    # このファイル（目次）
├── stories/
│   ├── US-001.md              # グローバル Git 設定の管理
│   ├── US-002.md              # プロジェクト別 Git 設定の上書き
│   ├── US-003.md              # SSH 鍵ペアの登録・管理
│   ├── US-004.md              # Docker 環境への設定自動適用
│   └── US-005.md              # 設定画面 UI の提供
└── nfr/
    ├── performance.md         # 性能要件
    ├── security.md            # セキュリティ要件
    ├── usability.md           # ユーザビリティ要件
    ├── compatibility.md       # 互換性要件
    └── extensibility.md       # 拡張性要件
```

## EARS記法クイックリファレンス

| パターン | 形式 | 使用場面 |
|---------|------|----------|
| 基本形 | システムは[振る舞い]しなければならない | 常時適用される要件 |
| イベント | [イベント]の時、システムは[振る舞い]しなければならない | イベント駆動要件 |
| 条件付き | もし[条件]ならば、システムは[振る舞い]しなければならない | 状態依存要件 |
| 継続的 | [状態]の間、システムは[振る舞い]しなければならない | 継続的要件 |
| 場所 | [場所]において、システムは[振る舞い]しなければならない | コンテキスト固有要件 |

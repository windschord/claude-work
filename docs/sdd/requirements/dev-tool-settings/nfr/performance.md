# 性能要件

> 非機能要件カテゴリ: 性能

## 概要

開発ツール設定管理機能は、ユーザー体験を損なわないために高速な応答性を提供する必要があります。特に、設定の読み込み、保存、Docker 環境への適用は頻繁に行われる操作であるため、パフォーマンス要件を明確にします。

## 要件一覧

### NFR-PERF-001: 設定読み込み性能

**EARS記法**: ユーザーが設定画面にアクセスした時、システムは 100ms 以内に設定データを読み込んで表示しなければならない

**測定基準**:
- 指標: API レスポンスタイム（`GET /api/developer-settings/*`）
- 目標値: 100ms 以内（P95）
- 測定方法:
  - サーバーサイドのレスポンスタイムログ
  - ブラウザ Developer Tools の Network タブで計測

**関連する機能要件**: REQ-001-003, REQ-002-005, REQ-003-004

**優先度**: 高

**検証方法**:
- [ ] 100 件のプロジェクト設定が存在する状態で設定画面を開き、100ms 以内に表示されることを確認
- [ ] SSH 鍵が 10 件登録されている状態で鍵一覧を表示し、100ms 以内にレンダリングされることを確認
- [ ] Performance API を使用して実測値を記録

---

### NFR-PERF-002: 設定保存性能

**EARS記法**: ユーザーが設定を保存した時、システムは 500ms 以内にデータベースへの保存を完了しなければならない

**測定基準**:
- 指標: API レスポンスタイム（`PUT /api/developer-settings/*`, `POST /api/ssh-keys`）
- 目標値: 500ms 以内（P95）
- 測定方法:
  - サーバーサイドのレスポンスタイムログ
  - データベースクエリ実行時間の計測

**関連する機能要件**: REQ-001-001, REQ-001-002, REQ-002-001, REQ-002-002, REQ-003-001

**優先度**: 高

**検証方法**:
- [ ] Git 設定の保存操作を 10 回実行し、すべてが 500ms 以内に完了することを確認
- [ ] SSH 鍵の登録（暗号化含む）が 500ms 以内に完了することを確認
- [ ] Drizzle のクエリログで実行時間を分析

---

## パフォーマンス最適化のための推奨事項

### データベースインデックス

- `DeveloperSettings(scope, project_id)` に複合インデックスを作成
- `SshKey(name)` にユニークインデックスを作成（重複チェックの高速化）

### キャッシング戦略

- グローバル設定は頻繁に変更されないため、メモリキャッシュの使用を検討
- Docker 環境への設定適用時、設定データを一時的にキャッシュ

### 暗号化処理の最適化

- SSH 鍵の暗号化/復号化処理は非同期で実行
- 鍵サイズが大きい場合は、暗号化をワーカースレッドで実行

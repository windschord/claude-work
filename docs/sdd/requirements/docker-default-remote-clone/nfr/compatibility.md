# 非機能要件: 互換性（Compatibility）

## 概要

Docker主体への移行においても、既存のHOSTモードセッションやデータとの後方互換性を維持し、ユーザーへの影響を最小化する。

## 要件

### 既存セッションの継続利用

- **NFR-001**: 既存のHOSTモードセッションは、システム更新後も引き続き動作しなければならない
- **NFR-002**: もし既存セッションがHOST環境を使用している場合、システムはそのセッションをそのまま実行しなければならない
- **NFR-003**: セッション一覧において、システムは各セッションの環境タイプを表示しなければならない

### データベーススキーマの後方互換性

- **NFR-004**: `Session`テーブルの`environment_id`がnullの場合、システムはデフォルトHOST環境を使用しなければならない
- **NFR-005**: `Project`テーブルの`remote_url`がnullの場合、システムはローカル登録プロジェクトとして扱わなければならない
- **NFR-006**: スキーマ変更は既存データに影響を与えてはならない（nullableフィールドのみ追加）

### HOSTモードの継続サポート

- **NFR-007**: ユーザーが明示的にHOST環境を選択した時、システムはHOST環境でセッションを作成しなければならない
- **NFR-008**: 環境選択ドロップダウンにおいて、システムはHOST環境を選択肢として表示しなければならない
- **NFR-009**: HOST環境の削除や無効化はできてはならない（レガシーサポートとして保持）

### 段階的移行

- **NFR-010**: 既存ユーザーに対して、システムは「Docker環境の利用を推奨します」という通知を表示してもよい
- **NFR-011**: 新規ユーザーに対して、システムはDockerがデフォルトであることを明示しなければならない
- **NFR-012**: ユーザーマニュアルにおいて、システムはHOSTモードからDockerモードへの移行方法を記載しなければならない

## テスト基準

- 既存のHOSTセッションが正常に動作すること
- データベースマイグレーション後もデータ損失がないこと
- HOST環境が引き続き選択・使用可能であること
- 新規セッションはデフォルトでDocker環境を使用すること

## 関連ストーリー

- US-001: デフォルト環境のDocker化
- US-004: 環境管理UI強化

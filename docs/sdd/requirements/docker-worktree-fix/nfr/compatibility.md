# 非機能要件: 互換性

## 概要

既存の機能とデータに影響を与えず、後方互換性を維持しなければならない。

## 要件（EARS記法）

### 後方互換性

- **NFR-008**: 既存のHost環境セッションは、システム更新後も正常に動作しなければならない
- **NFR-009**: データベーススキーマ変更が必要な場合、システムは既存データをマイグレーションしなければならない
- **NFR-010**: APIレスポンス形式は既存のクライアントと互換性を保たなければならない

### 環境分離

- **NFR-011**: Host環境とDocker環境のコードパスは明確に分離されなければならない
- **NFR-012**: 環境判別ロジックは単一箇所（AdapterFactory）に集約されなければならない
- **NFR-013**: 新しい環境タイプ（SSH）の追加が容易でなければならない

### テスト要件

- **NFR-014**: Host環境とDocker環境の両方でユニットテストが実行されなければならない
- **NFR-015**: 既存のテストが引き続きパスしなければならない
- **NFR-016**: Docker環境特有の動作にテストが追加されなければならない

## 受入基準

- [ ] 既存のHost環境セッションがすべて正常に動作する
- [ ] 既存のテストがすべてパスする
- [ ] Docker環境用のテストが追加される
- [ ] APIのブレーキングチェンジがない
